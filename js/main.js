"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var n=[],a=!0,o=!1,s=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(r){o=!0,s=r}finally{try{a||null==l["return"]||l["return"]()}finally{if(o)throw s}}return n}function _arrayWithHoles(e){if(Array.isArray(e))return e}window.onload=function(){function e(e,t){document.getElementById("NewChildWalletAddress").value="",document.getElementById("NewChildNickname").value="",document.getElementById("NewChild").classList.remove("active"),document.getElementsByClassName("AddNewChild")[0].classList.remove("open");var n=web3.fromAscii(t);A.addChild.sendTransaction(n,e,{from:web3.eth.accounts[0],gas:web3.getGas,to:I},function(e,t){e?console.log(e):(console.log("Receiver has been set: "+t),setTimeout(function(){console.log("hash recepit found"),location.reload()},7500))})}function t(e){document.getElementById("NewTask").classList.toggle("active"),document.getElementById("TaskChildAddress").value=""+e}function n(e,t,n,a,o){console.log("sending..",e,t,n,a,o),A.addTask.sendTransaction(t,e,n,a,o,{from:web3.eth.accounts[0],gas:web3.getGas,to:I},function(e,t){e?console.log(e):(document.getElementById("TaskDescription").value="",document.getElementById("TaskEndDate").value="",document.getElementById("TaskBounty").value="",document.getElementById("TaskUseDecay").value="",document.getElementById("NewTask").classList.remove("active"),console.log("Receiver has been set: "+t),setTimeout(function(){location.reload()},7500))})}function a(e){return new Promise(function(t,n){console.log("sending..",e),A.doChangeTaskToReview.sendTransaction(e,{from:web3.eth.accounts[0],gas:web3.getGas,to:I},function(e,a){e?n(error):t(a)})})}function o(e){return new Promise(function(t,n){console.log("sending..",e),A.doCompleteTask.sendTransaction(e,{from:web3.eth.accounts[0],gas:web3.getGas,to:I},function(e,a){e?n(error):t(a)})})}function s(e){return new Promise(function(t,n){console.log("sending..",e),A.doRejectTaskToReview.sendTransaction(e,{from:web3.eth.accounts[0],gas:web3.getGas,to:I},function(e,a){e?(console.log(e),n(error)):(console.log("Receiver has been set: "+a),t(a))})})}function i(e,t,n,a){for(var o=0;o<e.length;o++){var s=e[o];s.onclick=function(e){"toggle"===t&&s.classList.toggle("open"),"remove"===t&&s.classList.remove(n),"add"===t&&s.classList.add(n),a()}}}function l(e){console.log("layout: ",e),w(),document.getElementById(""+e).classList.add("active"),"Parent"==e&&r(),k()}function r(){var e=3;G&&(document.getElementById("BuyGo").classList.add("hidden"),e--),M&&(document.getElementById("AddFirstChild").classList.add("hidden"),e--),_&&(document.getElementById("AddFirstTask").classList.add("hidden"),e--),e>0&&document.getElementById("QuickStartGuide").classList.add("active")}function c(){return"undefined"!=typeof web3&&new Promise(function(e,t){web3.eth.getAccounts(function(n,a){n?t(n):(a=a.length>1?a[0]:a,e(a))})})}function d(e){return new Promise(function(t,n){web3.eth.getBalance(e,function(e,a){e?n(e):t(a)})})}function u(){return new Promise(function(e,t){var n=web3.eth.accounts[0];L.getParentsChildren.call(n,function(n,a){n?t(n):e(a)})})}function m(){var e=web3.eth.accounts[0];return new Promise(function(t,n){L.checkIfChild.call(e,function(e,a){e?n(e):t(a)})})}function y(){var e=web3.eth.accounts[0];return new Promise(function(t,n){L.getActiveTasksByChildAddress.call(e,function(e,a){e?n(e):t(a)})})}function p(e){var t=web3.eth.accounts[0];return new Promise(function(e,n){L.getReviewTasksByParentAddress.call(t,function(t,a){t?n(t):e(a)})})}function f(){var e=web3.eth.accounts[0];return new Promise(function(t,n){L.getActiveTasksByParentAddress.call(e,function(e,a){e?n(e):t(a)})})}function g(){var e=web3.eth.accounts[0];return new Promise(function(t,n){L.hasParentMadeTask.call(e,function(e,a){e?n(e):t(a)})})}function v(e){for(var t=e[0],n=e[1],a=0;a<n.length;a++)"0x0000000000000000000000000000000000000000000000000000000000000000"!==n[Y]&&h(t[a],n[a])}function h(e,n){var a=document.getElementsByClassName("child-template");if(a.length){var o=a[0].cloneNode(!0);o.getElementsByClassName("child-name")[0].innerHTML=web3.toAscii(e).replace(/['"]+/g,""),o.getElementsByClassName("action-container")[0].setAttribute("data-child",n),o.classList.add("active"),o.onclick=function(e){var n=e.target.attributes[1].nodeValue;t(n)},document.getElementById("ChildrenContainer").appendChild(o)}}function b(){document.getElementById("NoWallet").classList.add("active")}function w(){document.getElementById("NoWallet").classList.remove("active")}function k(){document.getElementById("Loading").classList.remove("active")}function N(e){e>0?(p().then(function(e){var t=_slicedToArray(e,6),n=t[0],a=t[1],i=t[2];t[3],t[4],t[5];if(a.length>0){for(Y=0;Y<a.length;Y++)if("0x0000000000000000000000000000000000000000000000000000000000000000"!==a[Y]){var l=document.getElementsByClassName("reviewable-task");if(l.length){var r=l[0].cloneNode(!0);r.getElementsByClassName("icon-container")[0].innerHTML="<span>"+i[Y]+" GO</span>";var c=web3.toAscii(a[Y])+"";r.getElementsByClassName("content")[0].innerHTML=c,r.getElementsByClassName("mark-task-as-completed")[0].dataset.taskid=n[Y],r.getElementsByClassName("reject-task")[0].dataset.taskid=n[Y],r.getElementsByClassName("reject-task")[0].onclick=function(e){e.preventDefault();var t=e.target.attributes[2].nodeValue;s(t).then(function(e){J.parentNode.parentNode.parentNode.removeChild(J.parentNode.parentNode),setTimeout(function(){location.reload()},7500)})},r.getElementsByClassName("mark-task-as-completed")[0].onclick=function(e){e.preventDefault();var t=e.target.attributes[2].nodeValue;o(t).then(function(e){J.parentNode.parentNode.parentNode.removeChild(J.parentNode.parentNode),setTimeout(function(){location.reload()},5500)})},r.classList.add("active"),document.getElementById("ReviewAbleTaskContainer").appendChild(r)}}}else console.log("no tasks for review.")}),f().then(function(e){var t=_slicedToArray(e,6),n=(t[0],t[1]),a=t[2];t[3],t[4],t[5];if(n.length>0){for(Y=0;Y<n.length;Y++)if("0x0000000000000000000000000000000000000000000000000000000000000000"!==n[Y]){var o=document.getElementsByClassName("parent-active-tasks")[0],s=o.cloneNode(!0);s.getElementsByClassName("task-bounty-value")[0].innerHTML=a[Y]+" GO";var i="";i+=web3.toAscii(n[Y])+"",s.getElementsByClassName("task-description-value")[0].innerHTML=i,s.classList.add("active"),document.getElementById("ParentActiveTasksContainer").appendChild(s)}}else console.log("no tasks for review.")})):y().then(function(e){var t=_slicedToArray(e,6),n=t[0],o=t[1],s=t[2],i=(t[3],t[4],t[5]);if(o.length>0){for(Y=0;Y<o.length;Y++)if("0x0000000000000000000000000000000000000000000000000000000000000000"!==o[Y]){var r=document.getElementsByClassName("active-tasks");if(r.length){var c=r[0].cloneNode(!0);c.getElementsByClassName("icon-container")[0].innerHTML="<span>"+s[Y]+" GO</span>";var d=web3.toAscii(o[Y])+"";c.getElementsByClassName("content")[0].innerHTML=d,c.getElementsByClassName("mark-task-for-review")[0].dataset.taskid=n[Y],c.getElementsByClassName("mark-task-for-review")[0].dataset.childaddress=i[Y],c.onclick=function(e){e.preventDefault();var t=e.target.attributes[3].nodeValue;a(t).then(function(e){console.log("marked for review..",e),J.parentNode.parentNode.parentNode.removeChild(J.parentNode.parentNode),setTimeout(function(){location.reload()},5500)})},c.classList.add("active"),document.getElementById("ChildTaskContainer").appendChild(c)}}l(P)}else console.log("no tasks for review.")})}try{var C=(new Web3(web3.currentProvider||new Web3.providers.HttpProvider("https://testnet-rpc.gochain.io:443")),new Web3(new Web3.providers.HttpProvider("https://testnet-rpc.gochain.io:443"))),B=JSON.parse('[{"constant":false,"inputs":[{"name":"_creator","type":"address"}],"name":"getActiveTasksByParentAddress","outputs":[{"name":"","type":"uint256[]"},{"name":"","type":"bytes32[]"},{"name":"","type":"uint128[]"},{"name":"","type":"uint128[]"},{"name":"","type":"uint128[]"},{"name":"","type":"address[]"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_parent","type":"address"}],"name":"checkIfChild","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_taskId","type":"uint128"}],"name":"doCompleteTask","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_name","type":"bytes32"},{"name":"_child","type":"address"}],"name":"addChild","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_creator","type":"address"}],"name":"hasParentMadeTask","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"Children","outputs":[{"name":"name","type":"bytes32"},{"name":"parentAddress","type":"address"},{"name":"childAddress","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_taskId","type":"uint128"}],"name":"doChangeTaskToReview","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_creator","type":"address"}],"name":"getReviewTasksByParentAddress","outputs":[{"name":"","type":"uint256[]"},{"name":"","type":"bytes32[]"},{"name":"","type":"uint128[]"},{"name":"","type":"uint128[]"},{"name":"","type":"uint128[]"},{"name":"","type":"address[]"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_taskId","type":"uint128"}],"name":"doRejectTaskToReview","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_value","type":"bytes32"},{"name":"_assignee","type":"address"},{"name":"_startDate","type":"uint128"},{"name":"_endDate","type":"uint128"},{"name":"_bounty","type":"uint128"}],"name":"addTask","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_parent","type":"address"}],"name":"getParentsChildren","outputs":[{"name":"","type":"bytes32[]"},{"name":"","type":"address[]"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"Tasks","outputs":[{"name":"value","type":"bytes32"},{"name":"creator","type":"address"},{"name":"assignee","type":"address"},{"name":"bounty","type":"uint128"},{"name":"startDate","type":"uint128"},{"name":"endDate","type":"uint128"},{"name":"useDecay","type":"bool"},{"name":"active","type":"bool"},{"name":"review","type":"bool"},{"name":"paid","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_assignee","type":"address"}],"name":"getActiveTasksByChildAddress","outputs":[{"name":"","type":"uint256[]"},{"name":"","type":"bytes32[]"},{"name":"","type":"uint128[]"},{"name":"","type":"uint128[]"},{"name":"","type":"uint128[]"},{"name":"","type":"address[]"}],"payable":false,"stateMutability":"nonpayable","type":"function"}]'),E=web3.eth.contract(B),T=C.eth.contract(B),I="0xe5EF8686824D69D69654BFEEffEb47D6eA8a499C",A=E.at(I),L=T.at(I),P="Child",M=0,_=0,D=[];web3.eth.getAccounts(function(e,t){null!=e?console.error("An error occurred: "+e):0==t.length?(k(),b()):w()}),m().then(function(e){e===!1?(P="Parent",u().then(function(e){for(var t=e[1],n=e[0],a=0;a<n.length;a++)1==t[a].includes("0x0000000000000000000000000000000000000000")&&(t.splice(a,1),n.splice(a,1));e=[n,t],D=e,t=e[1],n=e[0],n.length>0?(v(e),M=1):M=0,g().then(function(e){_=e,N(M),l(P)})})):N(M)})}catch(H){console.log("error loading web3.",H)}var R=0,G=0;"undefined"==typeof window.web3?console.error("Please use a web3 browser"):(w(),c().then(function(e){"undefined"==typeof e?(console.log("no wallet."),k(),b()):(w(),R=e[0],d(R).then(function(e){var t='<i class="fas fa-usd-circle"></i> '+web3.fromWei(e,"ether").toFixed(2)+" GO";C.fromWei(e,"ether").toFixed(2)>0&&(G=1),document.getElementById("GoBalance").innerHTML=t}))}));var W=document.getElementsByClassName("test-metamask");i(W,"","",function(){metaMaskAuth()});var x=document.getElementsByClassName("cancelChild");i(x,"remove","open",function(){document.getElementsByClassName("AddNewChild")[0].classList.remove("open"),document.getElementById("NewChild").classList.remove("active")});var F=document.getElementsByClassName("AddNewChild");i(F,"toggle","open",function(){document.getElementById("NewChild").classList.toggle("active")});var j=document.getElementsByClassName("addNewChildSubmit")[0];j.onclick=function(t){t.preventDefault(),console.log("you are submiting a new child");var n=document.getElementById("NewChildWalletAddress").value,a=web3.eth.accounts[0],o='"'+document.getElementById("NewChildNickname").value+'"',s=1,i="";if(n=n.toUpperCase(),a=a.toUpperCase(),0===n.localeCompare(a)&&(s=0,i="You are trying to add yourself as a child.  Please use another address."),D.length){console.log("you have kids.",D);for(var l=D[1],r=0;r<l.length;r++)console.log("a kid...",r),l[r]===n&&(s=0,i="You have already added this child.")}console.log(s,i),s>0?(document.getElementById("NewChildErrors").innerHTML="",document.getElementById("NewChildErrors").classList.remove("active"),e(n,o)):(console.log("cant send"),document.getElementById("NewChildErrors").innerHTML=i,document.getElementById("NewChildErrors").classList.add("active"))};var O=document.getElementById("AddNewTaskSubmit");O.onclick=function(e){console.log("you clicked submit new task");var t=document.getElementById("TaskChildAddress").value,a=web3.fromAscii(document.getElementById("TaskDescription").value),o=document.getElementById("TaskEndDate").value;o=new Date(o).getTime();var s=(new Date).getTime(),i=document.getElementById("TaskBounty").value,l=document.getElementById("TaskUseDecay").value===!0;n(t,a,s,o,i,l)};var S=document.getElementsByClassName("cancelTask");i(S,"remove","open",function(){document.getElementById("NewTask").classList.remove("active")});var U=document.getElementsByClassName("AddNewTask");U.length&&(U[0].onclick=function(e){var t=document.getElementsByClassName("cloneable");if(t.length){var n=t[0].cloneNode(!0);document.getElementById("TaskBlocks").appendChild(n)}});for(var V=document.getElementsByClassName("mark-task-as-completed"),Y=0;Y<V.length;Y++){var J=V[Y];J.onclick=function(e){e.preventDefault();var t=J.dataset.taskid;o(t).then(function(e){J.parentNode.parentNode.parentNode.removeChild(J.parentNode.parentNode),setTimeout(function(){location.reload()},5500)})}}for(var Q=document.getElementsByClassName("mark-task-for-review"),Y=0;Y<Q.length;Y++){var J=Q[Y];J.onclick=function(e){e.preventDefault();var t=J.dataset.taskid;a(t).then(function(e){J.parentNode.parentNode.parentNode.removeChild(J.parentNode.parentNode),setTimeout(function(){location.reload()},5500)})}}for(var q=document.getElementsByClassName("reject-task"),Y=0;Y<q.length;Y++){var J=q[Y];J.onclick=function(e){e.preventDefault();var t=J.dataset.taskid,n=J.dataset.childaddress;s(t,n).then(function(e){J.parentNode.parentNode.parentNode.removeChild(J.parentNode.parentNode),setTimeout(function(){location.reload()},5500)})}}};